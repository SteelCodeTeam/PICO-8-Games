pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--pico_os!
cmd=""
co=7
files={}
fc={}
hi={}
t=0
fs={
    ls="list files",
    cat="read file", 
    echo="print text",
    cls="clear screen",
    uptime="show uptime",
    exit="shutdown system",
    help="show commands"
}

function _init()
    poke(0x5f2d,0x1)
    poke(0x5f30,1)
    op("pico-os v.1k")
    op("type 'help' for commands")
    cls()
end

function _update()
    t += 1
    poke(0x5f30,1)
    local key,keyp=stat(30),stat(31)
    if key then
        if keyp=="\b" then
            if #cmd>0 then cmd=sub(cmd,1,#cmd-1) end
        elseif keyp=="\r" or keyp=="\n" then
            run(cmd)
            cmd=""
        elseif keyp>=" " then
            cmd=cmd..keyp
        end
    end
end

function _draw()
    cls()
    local y=0
    for h in all(hi) do
        if y>110 then
            del(hi,hi[1])
            y=0
        end
        y+=7
        print(h,0,y,co)
    end
    y+=7
    print("> "..cmd..(time()%1<0.5 and "_" or " "),0,y,co)
end

function op(text)
    add(hi,text)
end

function trim(str)
    while sub(str,1,1)==" " do str=sub(str,2) end
    while #str>0 and sub(str,#str,#str)==" " do str=sub(str,1,#str-1) end
    return str
end

function ga(cmm,sp)
    local i=sp
    while i<=#cmm and sub(cmm,i,i)==" " do i+=1 end
    return i<=#cmm and sub(cmm,i) or ""
end

function run(cmm)
    if cmm=="cls" then
        hi={}
        return
    else
        op("> "..cmm)
    end

    if cmm=="help" then
        for cmd,desc in pairs(fs) do
            op(" "..cmd.." - "..desc)
        end
    elseif sub(cmm,1,4)=="echo" then
        local parts=split(cmm,">")
        parts[1]=trim(sub(parts[1],6))
        if #parts[1]>0 then
            if not parts[2] then
                op(parts[1])
            else
                local fnm=trim(parts[2])
                add(files,fnm)
                fc[fnm]=parts[1]
            end
        end
    elseif sub(cmm,1,3)=="cat" then
        local fnm=ga(cmm,4)
        if fnm!="" and fc[fnm] then
            op(" "..fc[fnm])
        else
            op(" cat: "..fnm..": no such file or directory")
        end
    elseif cmm=="ls" then
        if #files==0 then
            op("no files")
        else
            for file in all(files) do
                op(" "..file)
            end
        end
    elseif cmm=="uptime" then
        op("system up: "..flr(t/30).."s")
    elseif cmm=="exit" then
        print("seeya!")
        stop()
    else
        op("command: '"..cmm.."' not found")
    end
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00666066606660000066606660000000000000000000777077707770777000000000777077700770000000000000000000000000000000000000000000000000
00606066606060060000606060000000000000000000070007007770700007000000007070007000000000000000000000000000000000000000000000000000
00666060606660000066606060000000000000000000070007007070770000000000777077707770000000000000000000000000000000000000000000000000
00606060606000060060006060000000000000000000070007007070700007000000700000700070000000000000000000000000000000000000000000000000
00606060606000000066606660000000000000000000070077707070777000000000777077707700000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00606066606000000066600000600066606660666000aa00aaa0a0a0aaa0a00000000000aa000000000000000000000000000000000000000000000000000000
00606060006000060000600000600060606060006000a0a00a00a0a0a000a0000a0000000a000000000000000000000000000000000000000000000000000000
00606066006000000006600000666066606660006000a0a00a00a0a0aa00a000000000000a000000000000000000000000000000000000000000000000000000
00666060006000060000600000606000606060006000a0a00a00aaa0a000a0000a0000000a000000000000000000000000000000000000000000000000000000
00060066606660000066600600666000606660006000a0a0aaa00a00aaa0aaa000000000aaa00000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00666066606660060000006600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00600060606000606006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00660066006600606000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00600060606000660006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00600060606660066000006660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cc7c7c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777777777
00007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777000000000
00000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007700000000000000
00000000007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000770000000000000000
00000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000
00000000000007700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000
00000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007700000000000000000000
00000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000
00000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000
00000000000000000077000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000
00000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000000
00000000000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000007700000000000000000000000000
00000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000
00000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000
00000000000000000000000070000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000
00000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000
00000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000
00000000000000000000000000070000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000
00000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000
00000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000
00000000000000000000000000000070000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000
00000000000000000000000000000007000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000
00000000000000000000000000000000700000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000
00000000000000000000000000000000070000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000
00000000000000000000000000000000007000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000
00000000000000000000000000000000000700000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000
00000000000000000000000000000000000077000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000
00000000000000000000000000000000000000700000000000000000000000000000000000000000000070000000000000000000000000000000000000000000
00000000000000000000000000000000000000070000000000000000000000000000000000000000007700000000000000000000000000000000000000000000
00000000000000000000000000000000000000007000000000000000000000000000000000000000070000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000700000000000000000000000000000000000000700000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000077000000000000000000000000000000000007000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000700000000000000000000000000000000770000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000070000000000000000000000000000007000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000007700000000000000000000000000770000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000077000000000000000000000077000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000770000000000000000007700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007770000000000000770000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000007777777777777000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

